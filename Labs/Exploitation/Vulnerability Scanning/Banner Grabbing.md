- Banner grabbing is an information gathering technique used by penetration testers to enumerate information regarding the target operating system as well as the services that are running on its open ports
- The primary objective of banner grabbing is to identify the service running on a specific port as well as the service version
- Banner grabbing can be performed through various techniques:
	- Performing a service version detection scan with Nmap
	- Connecting to open port with Netcat
	- Authenticating with the service (If the service supports authentication) for example: SSH,FTP,Telnet etc.

Target identification
```
root@attackdefense:~# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.1.0.4  netmask 255.255.0.0  broadcast 10.1.255.255
        ether 02:42:0a:01:00:04  txqueuelen 0  (Ethernet)
        RX packets 95  bytes 9143 (8.9 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 73  bytes 311274 (303.9 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.67.78.2  netmask 255.255.255.0  broadcast 192.67.78.255
        ether 02:42:c0:43:4e:02  txqueuelen 0  (Ethernet)
        RX packets 17  bytes 1486 (1.4 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 18  bytes 1656 (1.6 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 18  bytes 1656 (1.6 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

basic nmap scan:

```
root@attackdefense:~# nmap -sV -O 192.67.78.3
Starting Nmap 7.70 ( https://nmap.org ) at 2023-08-09 09:16 UTC
Nmap scan report for target-1 (192.67.78.3)
Host is up (0.000031s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
MAC Address: 02:42:C0:43:4E:03 (Unknown)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.70%E=4%D=8/9%OT=22%CT=1%CU=40588%PV=N%DS=1%DC=D%G=Y%M=0242C0%TM
OS:=64D35986%P=x86_64-pc-linux-gnu)SEQ(SP=109%GCD=1%ISR=109%TI=Z%CI=Z%II=I%
OS:TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7%O5
OS:=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6=
OS:FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%
OS:A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0
OS:%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S
OS:=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R
OS:=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N
OS:%T=40%CD=S)

Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.06 seconds
```

Incase if we are unable to find the version how to get the banner using the banner script in nmap

```
root@attackdefense:~# cat /usr/share/nmap/scripts/script.db | grep "banner"
Entry { filename = "banner.nse", categories = { "discovery", "safe", } }
root@attackdefense:~# nmap -sV --script=banner 192.67.78.3
Starting Nmap 7.70 ( https://nmap.org ) at 2023-08-09 09:19 UTC
Nmap scan report for target-1 (192.67.78.3)
Host is up (0.000010s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
|_banner: SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.6
MAC Address: 02:42:C0:43:4E:03 (Unknown)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds
```

Banner grabbing with the help of netcat

```
root@attackdefense:~# whatis netcat
netcat (1)           - TCP/IP swiss army knife
root@attackdefense:~# nc 192.67.78.3 22
SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.6
```

Banner grabbing while we try to authenticate

```
root@attackdefense:~# ssh root@192.67.78.3
The authenticity of host '192.67.78.3 (192.67.78.3)' can't be established.
ECDSA key fingerprint is SHA256:dxlBXgBb0Iv5/LmemZ2Eikb5+GLl9CSLf/B854fUeV8.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.67.78.3' (ECDSA) to the list of known hosts.
Welcome to attack defense ssh recon lab!!
root@192.67.78.3's password:
```

If we are to try to login we are unable to get the version info that we are looking for once we find the information that we are looking for we can find the vulnerabilities from searchsploit.

```
root@attackdefense:~# searchsploit openssh 7.2
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                                                                                                                                       |  Path
                                                                                                                                                                                                                                     | (/usr/share/exploitdb/)
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
OpenSSH 7.2 - Denial of Service                                                                                                                                                                                                      | exploits/linux/dos/40888.py
OpenSSH 7.2p1 - (Authenticated) xauth Command Injection                                                                                                                                                                              | exploits/multiple/remote/39569.py
OpenSSH 7.2p2 - Username Enumeration                                                                                                                                                                                                 | exploits/linux/remote/40136.py
OpenSSHd 7.2p2 - Username Enumeration                                                                                                                                                                                                | exploits/linux/remote/40113.txt
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Shellcodes: No Result
```

