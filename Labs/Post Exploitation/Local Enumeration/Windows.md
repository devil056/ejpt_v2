Enumerating System Information:

- After gaining an initial access to a target system, it is always important to learn more about the system like, what OS is running as well as the OS version. This information is very useful as it gives us an idea of what we can do and what tyype of exploits we can run.
- What are we looking for?
	- Hostname
	- OS Name (Windows7,8 etc.)
	- OS build and service pack (Windows 7 SP1 7600)
	- OS architecture (x64/x86)
	- Installed updated/hotfixes

Lab details : 
1. Port scan service and default port scan
2. Port 80 HTTPFileServer
3. It is rejetto and has a metasploit module so run that module
4. We get a meterpreter session : commands to use `getuid` and `sysinfo`
5. Now we go ahead and launch shell `hostname` and `systeminfo`  another command `wmic qfe get Caption,Description,HotFixID,InstalledOn` also we can try to look for eula.txt file in C:/Windows/System32 folder.

--- 

Enumerating Users and Groups:

- After gaining initial access to a target system, it is alway important to learn more about the system like, what user account you have access to and other user accounts on the system
- What are we looking for:
	- Current user and privileges
	- Additional user information
	- Other users on the system
	- Groups
	- Members of the built in administrator group

Lab details: 
1. Port scan using nmap
2. Port 80 is running HTTPFileServer
3. Open browser and check and we see it is rejetto
4. Using msfconsole exploit the service.
5. `getuid` we got administrator rights in this scenario but to see the privileges we have got use command `getprivs` and currently logged on and user previously logged on by putting current session in bg
6. use the post exploitation module logged on and run it using the session in the background.
7. Back to the previous session and let us see how to get the same details manually `whoami`, `whoami /priv` -> to see the privileges user has got, `query user` -> currently logged on users, `net users` -> all accounts related to the system, `net user administrator` -> get information about a particular user
8. Based of the result for the command `net users` we can look for the information about that user using `net user <user_name>` and check if the account status if it is active or not. `net localgroup` the command is used to see all the groups available on the system. To see the other users of the Administrator group `net localgroup Administrators`


---

Enumerating Network Information:

What are we looking for when we are performing network enumeration?
- Current IP address and network adapter
- Internal networks
- TCP/UDP services running and their respective ports
- Other hosts on the network
- Routing table
- Windows firewall state

Lab details:
1. This lab environment also follows the same rejetto vuln
2. `ipconfig` -> current ip address and other details for additional info `ipconfig /all` all the details are listed
3. When ever we are connected to a DHCP enabled network IP address is likely to be changed. And we can see when the IP address was assigned to the device and when it will be expired. Default gateway and DHCP server are same which is common. DNS server -> Which DNS server the target is using. `route print` -> to print the routing table.
4. To see other devices on network `arp -a` will contain list of all devices on the network.
5. Display list of open connection and the services that are running and ports they are running on `netstat -ano`
6. Windows firewall configuration `netsh firewall show state` for the newer version systems use the command `netsh advfirewall firewall` and `netsh advfirewall show allprofiles` In this I can see that by default all the inbound all blocked and the outbound are allowed makes sense why we use reverse_tcp

---

Enumerating processes and services:

- After gaining initial access to a target system, it is always important to learn more about the system like, what processes, services and scheduled tasks are currently running
- What are we looking for 
	- Running processes and services
	- Scheduled tasks
- A process is an instance of a running executable (.exe) or program
- A service is a process which runs in the background and does not interact with the desktop

Lab details:
1. Same as the previous labs it is also installed with Rejetto file server.
2. Once we get the meterpreter session in order to list the processes that are running we need to run the command `ps`
3. Incase we do not have access to system as Administrator we can check for the process running with NT Authority\System privilege and migrate to that particular privillege the reason being even if you are not logged in as privileged user we can list all the processes and see the services that are running but under the user it will display just the user we are logged in as.
4. Identify the explorer.exe and use the command `migrate PID` or we can simply use the command to find the PID `pgrep explorer.exe` 
5. In command shell `net start` will list all the services that are running on the system another command that can perform the same operation is `wmic service list brief`
6. We can also do the same using the tasklist `tasklist /SVC` with this we can see the services that are running in conjunction with the process
7. Listing a scheduled tasks command `schtasks /query /fo LIST` should copy and paste into a file as it will be helpful in post exploitation
8.  `schtasks /query /fo LIST /v` just enabling verbose option for more information


---

Automating Windows Local Enumeration

- In addition to performing local enumeration manually, we can also automate the process with the help of few scripts and MSF modules.
- While local enumeration techniques/commands are important to know, as a penetration tester, you will need to be time efficient. As a result, you will need to learn how to utilize various automated enumeration scripts
- In addition to automating the process of enumerating information like system information, users and groups etc, these automated enumeration scripts will also provide you with additional information regarding the target system like; privilege escalation vulnerabilities, locally stored passwords etc.

Windows local enum scripts

- JAWS -  Just Another Windows(Enum) Script - JAWS is a PowerShell script designed to help penetration testers (and CTFers) quickly identify potential privilege escalation vectors on Windows Systems. It is written using Powershell 2.0 so 'should' run on every Windows version since Windows 7.
	- GitHub repo: https://github.com/411Hall/JAWS

Lab details:
- nmap scan -p 5985 targeting winrm 
- We need the credentials Username: administrator and Password: tinkerbell
- Launch msfconsole and search winrm and select winrm_script_exec no need to change the meterpreter set all the necessary options and run the module.
- Do not forget to set FORCE_VBS to true
- sysinfo, getuid are the first commands to run.
- show_mount to list all the drives and background the session
- search win_privs and set session id and run the module
- search enum_logged to see all the logged in users
- search check_vm to see if the system exploited is a virtual machine or bare metal installation.
- search enum_applications to see the applications installed.
- search enum_computers to see all the computers that are connected on the same network.
- search enum_patches to see all the patches and hotfixes.
- search enum_shares to see all the shares available on SMB
- Using JAWS make a file with the same extension as in github and upload it to the Temp directory in the target system
- Running JAWS using shell `powershell.exe -ExecutionPolicy Bypass -File .\jaws-enum.ps1 -OutputFilename JAWS-Enum.txt`

---

Automating Linux Local Enumeration

- In addition to performing local enumeration manually, we can also automate the process with the help of a few scripts and MSF modules
- While local enumeration techniques/commands are important to know, as a penetration tester, you will need to be time efficient. As a result, you will need to learn how to utilize various automated enumeration scripts
- In addition to automating the process of enumeration information like system information, users and groups etc these automated enumeration scripts will also provide you with additional information regarding the target system like; privilege escalation vulnerabilities, locally stored passwords etc.
- LinEnum is a simple bash script that automates common linux local enumeration checks in addition to identifying privilege escalation vulnerabilities 
	- github repo : https://github.com/rebootuser/LinEnum
